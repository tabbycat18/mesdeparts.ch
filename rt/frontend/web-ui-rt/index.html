<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Mes Départs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="bus-icon-1.svg" />
    <link rel="apple-touch-icon" href="bus-icon-1.png" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="modulepreload" href="main.v2026-02-19.js" />
    <link rel="prefetch" href="clock/index.html" as="document" />
    <link rel="prefetch" href="clock/js/sbbUhr-1.3.js" as="script" />
    <meta name="theme-color" content="#01157f" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="application-name" content="Mes Départs" />
    <meta
      name="description"
      content="Tableau de départs avec horloge sbbUhr (Apache 2.0), sans affiliation officielle CFF/SBB."
    />
    <link rel="preload" href="style.v2026-02-19.css" as="style" />
    <link rel="modulepreload" href="logic.v2026-02-19.js" as="script" />
    <link rel="modulepreload" href="ui.v2026-02-19.js" />
    <link rel="modulepreload" href="state.v2026-02-19.js" />
    <link rel="modulepreload" href="i18n.v2026-02-19.js" />
    <link rel="modulepreload" href="infoBTN.v2026-02-19.js" />
    <link rel="modulepreload" href="favourites.v2026-02-19.js" />
    <link rel="modulepreload" href="ui/headerControls2.js" />
    <script>
      (function markEmbed() {
        if (window.self === window.top) return;
        document.documentElement.classList.add("dual-embed");
        if (document.body) {
          document.body.classList.add("dual-embed");
        } else {
          document.addEventListener("DOMContentLoaded", () => {
            document.body && document.body.classList.add("dual-embed");
          });
        }
      })();
    </script>
    <script>
      window.__MD_API_BASE__ = window.__MD_API_BASE__ || "";
    </script>
    <link rel="stylesheet" href="style.v2026-02-19.css" />
    <link rel="stylesheet" href="ui/headerControls2.css" />
  </head>
  <body>
    <div class="mobile-fullscreen-wrapper">
      <div class="board">
        <div class="version-tag" aria-label="Version">v1.7.1</div>
        <header id="header-controls2-mount" class="board-header"></header>

        <div id="line-chips" class="line-chips">
          <span class="line-chips-label">Desservi par les lignes :</span>
          <div id="line-chips-container" class="line-chips-container"></div>
        </div>

        <main>
          <div class="departures-scroller">
            <table class="departures">
              <caption id="departures-caption" class="sr-only">
                Vos prochains départs
              </caption>
              <thead>
                <tr>
                  <th scope="col" class="col-line">Ligne</th>
                  <th scope="col" class="col-dest">Destination</th>
                  <th scope="col" class="col-time">Départ</th>
                  <th scope="col" class="col-platform">Voie</th>
                  <th scope="col" class="col-min col-min-header">min</th>
                  <th scope="col" class="col-remark">Remarque</th>
                </tr>
              </thead>
              <tbody id="departures-body">
                <!-- lignes injectées par main.*.js -->
              </tbody>
            </table>
          </div>
        </main>

        <footer class="board-footer">
          <span id="footer-note">
            Data: api.mesdeparts.ch — Horloge: sbbUhr (Apache 2.0) — Non
            officiel, aucune affiliation avec CFF/SBB/FFS ou les exploitants.
          </span>
        </footer>
      </div>
    </div>

    <!-- IMPORTANT: use main.v2026-02-19.js as an ES module -->
    <script type="module">
      import "./ui/headerControls2.js";
    </script>
    <script type="module" src="main.v2026-02-19.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        const path = window.location.pathname || "/";
        const isClock = path.startsWith("/clock");
        const allowed =
          path === "/" ||
          path === "/index.html" ||
          path === "/dual-board.html" ||
          path.startsWith("/?") ||
          path.startsWith("/dual-board.html?");

        const registerSW = () => {
          navigator.serviceWorker
            .register("/service-worker.js")
            .catch((err) => {
              console.error("Service worker registration failed", err);
            });
        };

        if (!isClock && allowed) {
          if (
            document.readyState === "complete" ||
            document.readyState === "interactive"
          ) {
            registerSW();
          } else {
            document.addEventListener("DOMContentLoaded", registerSW, {
              once: true,
            });
          }
        }
      }
    </script>

    <!-- Sprite SVG (icône bus "à l'arrêt" + panneaux réservés pour plus tard) -->
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none">
      <!-- Mode icons (header) -->
      <symbol id="icon-bus" viewBox="0 0 24 24">
        <path
          d="M7 16c0 .55-.45 1-1 1H5c-.55 0-1-.45-1-1v-1.07A3.98 3.98 0 0 1 3 12V6c0-3 3.58-3 8-3s8 0 8 3v6a3.98 3.98 0 0 1-1 2.93V16c0 .55-.45 1-1 1h-1c-.55 0-1-.45-1-1v-1H7v1Zm-2-5h14V6H5v5Zm2.5 6.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm9 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"
          fill="currentColor"
        />
      </symbol>

      <symbol id="icon-train" viewBox="0 0 24 24">
        <path
          d="M12 2c-4 0-8 .5-8 4v9c0 2 2 3 4 3l-2 2v1h2l3-3h2l3 3h2v-1l-2-2c2 0 4-1 4-3V6c0-3.5-4-4-8-4Zm-6 4c0-1.5 2.7-2 6-2s6 .5 6 2v2H6V6Zm0 4h12v5c0 .7-.8 1-2 1H8c-1.2 0-2-.3-2-1v-5Zm3 10a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm6 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"
          fill="currentColor"
        />
      </symbol>

      <symbol id="icon-tram" viewBox="0 0 24 24">
        <path
          d="M12 2c-3.8 0-7 .6-7 3.5V16c0 1.7 1.6 2.6 3.3 2.9L7 21v1h2l2-3h2l2 3h2v-1l-1.3-2.1C17.4 18.6 19 17.7 19 16V5.5C19 2.6 15.8 2 12 2Zm-5 4.2c0-.9 2-1.4 5-1.4s5 .5 5 1.4V8H7V6.2ZM7 10h10v5.5c0 .6-.8 1-2 1H9c-1.2 0-2-.4-2-1V10Zm2.2 9.7a1.3 1.3 0 1 0 0-2.6 1.3 1.3 0 0 0 0 2.6Zm5.6 0a1.3 1.3 0 1 0 0-2.6 1.3 1.3 0 0 0 0 2.6Z"
          fill="currentColor"
        />
      </symbol>

      <symbol id="icon-metro" viewBox="0 0 24 24">
        <path
          d="M12 2c-4 0-7 1-7 4v10c0 1.9 1.9 3 4 3l-2 2v1h2l3-3h0l3 3h2v-1l-2-2c2.1 0 4-1.1 4-3V6c0-3-3-4-7-4Zm-5 4c0-1.2 2.2-2 5-2s5 .8 5 2v2H7V6Zm0 4h10v6c0 .7-.9 1-2 1H9c-1.1 0-2-.3-2-1v-6Zm2 9a1.4 1.4 0 1 0 0-2.8 1.4 1.4 0 0 0 0 2.8Zm6 0a1.4 1.4 0 1 0 0-2.8 1.4 1.4 0 0 0 0 2.8Z"
          fill="currentColor"
        />
      </symbol>

      <symbol id="icon-boat" viewBox="0 0 24 24">
        <path
          d="M12 2 8 6h8l-4-4Zm7 9-7-3V7H5v4l-2 1v2l2.2-.9c1.2 2.6 3.8 4.4 6.8 4.4s5.6-1.8 6.8-4.4L21 13v-2ZM5 19c1 .7 2.4 1.2 4 1.2 1.7 0 3.2-.6 4-1.4.8.8 2.3 1.4 4 1.4 1.6 0 3-.5 4-1.2v2c-1 .7-2.4 1.1-4 1.1-1.9 0-3.6-.6-5-1.8-1.4 1.2-3.1 1.8-5 1.8-1.6 0-3-.4-4-1.1v-2Z"
          fill="currentColor"
        />
      </symbol>

      <!-- Icône bus "à l'arrêt" (min = 0) -->
      <symbol id="bus-arrival" viewBox="0 0 24 24">
        <path
          d="M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3-3.58-3-8-3S4 3 4 6v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14 9 14.67 9 15.5 8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5S15.67 14 16.5 14 18 14.67 18 15.5 17.33 17 16.5 17zM6 11V6h12v5H6z"
          fill="currentColor"
        />
      </symbol>

      <!-- new train arrival icon -->
      <symbol id="train-arrival" viewBox="0 0 24 24">
        <path
          d="M0 22.5V1.5C0 0.675 0.675 0 1.5 0H22.5C23.325 0 24 0.675 24 1.5V22.5C24 23.325 23.325 24 22.5 24H1.5C0.675 24 0 23.325 0 22.5Z"
          fill="#01157f"
        />
        <path
          d="M20.711 18.862C20.918 18.862 21.086 18.694 21.086 18.487C21.086 18.469 21.085 18.451 21.082 18.434L20.763 16.198H16.874V18.862H20.711Z"
          fill="white"
        />
        <path
          d="M11.634 8.193H2.99999V7.5H10.05L7.83699 6L12 3.637L16.137 6H16.162L13.949 7.5H18.545C19.105 7.5 19.58 7.912 19.659 8.466L20.662 15.488H2.99899V11.776H11.633C11.835 11.776 11.999 11.612 11.999 11.41C11.999 11.208 11.835 11.044 11.633 11.044H2.99899V10.35H11.633C11.835 10.35 11.999 10.186 11.999 9.984C11.999 9.782 11.835 9.618 11.633 9.618H2.99899V8.925H11.633C11.835 8.925 11.999 8.761 11.999 8.559C11.999 8.357 11.835 8.193 11.634 8.193ZM16.649 11.4C16.649 11.607 16.817 11.775 17.024 11.775H18.979C19.186 11.775 19.354 11.607 19.354 11.4C19.354 11.382 19.353 11.364 19.35 11.347L18.945 8.516C18.919 8.331 18.76 8.194 18.574 8.194H17.023C16.816 8.194 16.648 8.362 16.648 8.569V11.4H16.649ZM12.679 7.5L14.804 6.06L11.998 4.458L9.18499 6.054L11.319 7.5H12.679Z"
          fill="white"
        />
        <path
          d="M7.79099 18.021C7.79099 16.965 8.64799 16.109 9.70399 16.109C10.759 16.109 11.616 16.966 11.616 18.021C11.616 19.077 10.759 19.934 9.70399 19.934C8.64699 19.933 7.79099 19.077 7.79099 18.021Z"
          fill="white"
        />
        <path
          d="M12.299 18.021C12.299 16.965 13.156 16.109 14.212 16.109C15.268 16.109 16.124 16.966 16.124 18.021C16.124 19.077 15.267 19.934 14.212 19.934C13.156 19.933 12.299 19.077 12.299 18.021Z"
          fill="white"
        />
        <path d="M21 3V3.375H3V3H21Z" fill="white" />
        <path d="M3 21V20.288H21V21H3Z" fill="white" />
        <path d="M3 16.313V16.2H7.125V18.862H3V16.313Z" fill="white" />
      </symbol>

      <!-- Panneau bus TL / SBB générique (réservé si tu veux l'utiliser plus tard) -->
      <symbol id="tl-bus-sign" viewBox="0 0 24 24">
        <path
          d="M0 22.5V1.5C0 0.675 0.675 0 1.5 0H22.5C23.325 0 24 0.675 24 1.5V22.5C24 23.325 23.325 24 22.5 24H1.5C0.675 24 0 23.325 0 22.5Z"
          fill="#2D327D"
        />
        <path
          d="M20.711 18.862C20.918 18.862 21.086 18.694 21.086 18.487C21.086 18.469 21.085 18.451 21.082 18.434L20.763 16.198H16.874V18.862H20.711Z"
          fill="white"
        />
        <path
          d="M11.634 8.193H2.99999V7.5H10.05L7.83699 6L12 3.637L16.137 6H16.162L13.949 7.5H18.545C19.105 7.5 19.58 7.912 19.659 8.466L20.662 15.488H2.99899V11.776H11.633C11.835 11.776 11.999 11.612 11.999 11.41C11.999 11.208 11.835 11.044 11.633 11.044H2.99899V10.35H11.633C11.835 10.35 11.999 10.186 11.999 9.984C11.999 9.782 11.835 9.618 11.633 9.618H2.99899V8.925H11.633C11.835 8.925 11.999 8.761 11.999 8.559C11.999 8.357 11.835 8.193 11.634 8.193ZM16.649 11.4C16.649 11.607 16.817 11.775 17.024 11.775H18.979C19.186 11.775 19.354 11.607 19.354 11.4C19.354 11.382 19.353 11.364 19.35 11.347L18.945 8.516C18.919 8.331 18.76 8.194 18.574 8.194H17.023C16.816 8.194 16.648 8.362 16.648 8.569V11.4H16.649ZM12.679 7.5L14.804 6.06L11.998 4.458L9.18499 6.054L11.319 7.5H12.679Z"
          fill="white"
        />
        <path
          d="M7.79099 18.021C7.79099 16.965 8.64799 16.109 9.70399 16.109C10.759 16.109 11.616 16.966 11.616 18.021C11.616 19.077 10.759 19.934 9.70399 19.934C8.64699 19.933 7.79099 19.077 7.79099 18.021Z"
          fill="white"
        />
        <path
          d="M12.299 18.021C12.299 16.965 13.156 16.109 14.212 16.109C15.268 16.109 16.124 16.966 16.124 18.021C16.124 19.077 15.267 19.934 14.212 19.934C13.156 19.933 12.299 19.077 12.299 18.021Z"
          fill="white"
        />
        <path d="M21 3V3.375H3V3H21Z" fill="white" />
        <path d="M3 21V20.288H21V21H3Z" fill="white" />
        <path d="M3 16.313V16.2H7.125V18.862H3V16.313Z" fill="white" />
      </symbol>

      <!-- Cadre SBB pour plus tard si tu veux faire un badge SVG complet -->
      <symbol id="sbb-r-frame" viewBox="0 0 59 20">
        <g clip-path="url(#sbb-r-clip)">
          <path
            stroke="#000"
            d="M2 .5h55A1.5 1.5 0 0 1 58.5 2v16a1.5 1.5 0 0 1-1.5 1.5H2A1.5 1.5 0 0 1 .5 18V2A1.5 1.5 0 0 1 2 .5Z"
          ></path>
          <path
            fill="#000"
            d="M4.069 4.224h5.704q1.692 0 2.594.531.749.435 1.144 1.16.395.727.395 1.636 0 1.032-.5 1.797-.491.765-1.377 1.095.78.195 1.224.87.282.427.379.895.097.467.25 2.135.112 1.224.346 1.523l.113.137h-2.683a2 2 0 0 1-.201-.637q-.058-.387-.154-1.788-.096-1.25-.612-1.725-.507-.483-1.74-.483H6.639v4.633h-2.57zm2.57 2.022v3.239h2.457q1.184 0 1.668-.339.612-.426.612-1.289 0-.837-.524-1.224t-1.651-.387zM23.848 11.322v1.99h-1.483v2.69H20.07v-2.69h-4.914v-2.208l5.035-6.88h2.175v7.098zm-3.73.024V6.963l-3.03 4.383z"
          ></path>
        </g>
        <defs>
          <clipPath id="sbb-r-clip">
            <path fill="#fff" d="M0 0h59v20H0z"></path>
          </clipPath>
        </defs>
      </symbol>
    </svg>
  </body>
</html>
